webpackJsonp([17],{Dgxh:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAWJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IlhNUCBDb3JlIDUuNC4wIj4KICAgPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4KICAgICAgPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIKICAgICAgICAgICAgeG1sbnM6ZXhpZj0iaHR0cDovL25zLmFkb2JlLmNvbS9leGlmLzEuMC8iPgogICAgICAgICA8ZXhpZjpVc2VyQ29tbWVudD5TY3JlZW5zaG90PC9leGlmOlVzZXJDb21tZW50PgogICAgICA8L3JkZjpEZXNjcmlwdGlvbj4KICAgPC9yZGY6UkRGPgo8L3g6eG1wbWV0YT4KbszeLgAAAPRJREFUWAljYBjpgJHcAEhPT/f4//+/BUg/kD45e/bs7eSYxUKOJpCef//+eTAyMuZD9U8G0mQ5gAlqwIBRow4YDYHREBgNgQEPAXhdkJKS4gosWquJLRKBalWAaqWh6p8C64M7xOoFqmsH1h07QerhdQHQQAkgtifBEGSl0kC9MMcgi+Niz4dJDHgUwEMAGIQXgb5ohLmMCNoDqMYcpA6o9xRQL9G1IVDtBZj58DQAEyCWTk1NnQA0CFwdAx0wGRinecTqRVY34FEw6oDREBgNgdEQGPAQgNcFyMUjMWxgz2gKsCjeAFILLIqfEKNnVA22EAAAMY41uEN/5TkAAAAASUVORK5CYII="},M7nC:function(e,t){},ROZC:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=i("tlGt"),a=i("YtJ0"),o=i("mw3O"),n=i.n(o),l=i("Au9i"),c={name:"Release",data:function(){return{hasVideo:!1,relaFiles:[],hasFile:!1,formData:{},preViews:[],videoPreview:{},dataForm:{blog:"",position:""},isShow:!1,hasMask:!1}},mounted:function(){this.formData=new FormData,this.hasFiles()},methods:{hasPic:function(){Object(l.Toast)({message:"请选择图片",duration:1500})},hasFiles:function(){return 0===this.$refs.pic.files.length&&0===this.$refs.camera.files.length?this.hasFile=!1:this.hasFile=!0,this.hasFile},back:function(){this.$router.go(-1)},edit:function(){var e=this;if(console.log(this.dataForm.blog),console.log(this.formData),""===this.dataForm.blog&&0===this.$refs.pic.files.length&&0===this.$refs.camera.files.length&&0===this.$refs.video.files.length)Object(l.Toast)({message:"动态内容不能为空",duration:1e3});else if(console.log(a.a.state.uploadFileType),"isVideo"===a.a.state.uploadFileType){var t=this.videoPreview.relaFile+","+this.videoPreview.videoUrl;Object(s.n)(n.a.stringify({files:t,montNote:this.dataForm.blog,catType:"1"})).then(function(t){console.log(t),"0"===t.status&&(Object(l.Toast)({message:"发布成功",duration:1500}),e.$router.go(-1))})}else{for(var i=0;i<this.preViews.length;i++)this.relaFiles.push(this.preViews[i].relaFile);Object(s.n)(n.a.stringify({files:this.relaFiles.join(","),montNote:this.dataForm.blog,catType:"0"})).then(function(t){console.log(t),"0"===t.status&&(Object(l.Toast)({message:"发布成功",duration:1500}),e.$router.go(-1))})}},add:function(){this.isShow=!this.isShow,this.hasMask=!this.hasMask,this.hasFiles()},getCamera:function(){navigator.camera.getPicture(function(e){document.getElementById("myImage").src=e,alert(e)},function(e){alert("Failed because: "+e)},{quality:50,destinationType:Camera.DestinationType.DATA_URL,sourceType:Camera.PictureSourceType.PHOTOLIBRARY})},getPic:function(){this.$refs.pic.click(),a.a.commit("getUploadFileType","isPic")},getVideo:function(){this.$refs.video.click(),a.a.commit("getUploadFileType","isVideo")},upLoadImg:function(){var e=this;if(this.add(),0!==this.$refs.pic.length){this.formData.append("scene","comm");for(var t=0;t<this.$refs.pic.files.length;t++)this.formData.append("files",this.$refs.pic.files[t])}Object(s._5)(this.formData,{headers:{"Content-Type":"multipart/form-data"}}).then(function(t){console.log(t),e.preViews=t.data})},getCover:function(){var e=this;this.add(),0!==this.$refs.video.length&&(this.formData.append("file",this.$refs.video.files[0]),this.formData.append("scene","comm"));l.Indicator.open({text:"视频上传中",spinnerType:"snake"}),Object(s.v)(this.formData,{headers:{"Content-Type":"multipart/form-data"}}).then(function(t){console.log(t),"0"===t.status?(Object(l.Toast)({message:"视频上传成功",duration:1e3}),setTimeout(function(){e.videoPreview=t.data,console.log(e.videoPreview.relaFile+","+e.videoPreview.videoUrl),e.hasVideo=!0,l.Indicator.close()},1e3)):Object(l.Toast)({message:"视频上传失败，请重新上传",duration:1500})})},getPosition:function(){Object(l.Toast)({message:"暂时不支持定位",duration:1500})}}},r={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"release"},[s("div",{staticClass:"header"},[s("span",{staticClass:"back",on:{click:e.back}},[s("img",{staticClass:"releaseIcon",attrs:{src:i("0YUB")}})]),e._v(" "),s("span",{staticClass:"edit",on:{click:e.edit}},[e._v("\n            发布\n        ")])]),e._v(" "),s("div",{staticClass:"content"},[s("div",{staticClass:"message"},[s("textarea",{directives:[{name:"model",rawName:"v-model",value:e.dataForm.blog,expression:"dataForm.blog"}],staticClass:"messageBox",attrs:{type:"text",placeholder:"请输入您想分享的事...",autofocus:"autofocus",maxlength:"200"},domProps:{value:e.dataForm.blog},on:{input:function(t){t.target.composing||e.$set(e.dataForm,"blog",t.target.value)}}})]),e._v(" "),s("div",{staticClass:"limit"},[e._v(e._s(e.dataForm.blog.length)+"/200")]),e._v(" "),e.hasVideo?s("div",{staticClass:"videoPreview"},[s("img",{attrs:{src:e.videoPreview.fullFile}})]):e._e(),e._v(" "),e._l(e.preViews,function(e,t){return s("div",{key:t,staticClass:"preViews"},[s("div",{staticClass:"preview"},[s("img",{attrs:{src:e.fullFile,id:"myImage"}})])])}),e._v(" "),!e.hasVideo||e.$refs.pic.files.length>8?s("div",{staticClass:"add",on:{click:e.add}},[s("img",{attrs:{src:i("Dgxh")}})]):e._e(),e._v(" "),s("div",{staticStyle:{clear:"both"}}),e._v(" "),s("ul",{directives:[{name:"show",rawName:"v-show",value:e.isShow,expression:"isShow"}],staticClass:"actionMenu"},[s("li",[s("label",{on:{click:e.getCamera}},[e._v("拍照")]),e._v(" "),s("input",{ref:"camera",staticStyle:{display:"none"},attrs:{type:"file",accept:"image/*",capture:"camera",id:"cameraTakePicture"}})]),e._v(" "),s("li",[s("label",{on:{click:e.getPic}},[e._v("相册")]),e._v(" "),s("input",{ref:"pic",staticStyle:{display:"none"},attrs:{type:"file",accept:"image/*"},on:{change:e.upLoadImg}})]),e._v(" "),e.hasFile?s("li",[s("label",{on:{click:e.hasPic}},[e._v("视频")])]):e._e(),e._v(" "),e.hasFile?e._e():s("li",[s("label",{on:{click:e.getVideo}},[e._v("视频")]),e._v(" "),s("input",{ref:"video",staticStyle:{display:"none"},attrs:{type:"file",accept:"video/*"},on:{change:e.getCover}})])])],2),e._v(" "),s("div",{staticClass:"location",on:{click:e.getPosition}},[e._m(0),e._v(" "),s("span",[e._v("定位")])]),e._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:e.hasMask,expression:"hasMask"}],staticClass:"mask",on:{click:e.add}})])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("span",[t("img",{attrs:{src:i("bsMe")}}),this._v(" "),t("span",{staticClass:"weizhi"},[this._v("所在位置")])])}]};var d=i("VU/8")(c,r,!1,function(e){i("M7nC")},"data-v-afb70526",null);t.default=d.exports},bsMe:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAADJklEQVRYR8XWWehuYxQG8N9RRCQUF26IzDIXF4aQecgUcY4xmUoyRVHKBZLpgiLkGFOElCFDxmS4MQ8ZQiJzcUjmHq1du32+79t7fy7+793e77vWetZaz3red5EFXosWOL6xAFbFodgLW2M9rIBP8SaexIP4eWhiYwAch6uwdjn/FZ/ge/5LZDusVt/n47YhIIYAWAV34TAk6I24Hy/jn1aQFbE3LsZOeAAB/cssIH0A4jRl3Q2P4Xh8OyCzM3ENXivbP6bZ9AG4AWfgesTpmHU47sMtOGUeAFviDTxbpPu75WQtnIiD6t/7uBYfdAJdjXOwFd6aBGJWBe7FkdgYH7WM047HsXLH4W/YH8+0/q+Oz/E0UpHl1jQAcf4jnsO+LatNatxSjfOKaF9hMzyEDWoa2tnejGOwJn7vIpgGIFmm9KcX6xu7hhMH4pGOs1TqbdyBk1t7RxQX4vP5oQCOxj3YvYA0dgmQyUglJq1XK9ONWps71shmJO8cCuDYyiSK91TLKAD+KhWcBmCN4k2zvzNewEmTxGlaC/Ypok1qwanYdgKrU5X0vtuCJZV5fD4xtAIZs+/K2Qkto01rNL/AwXin9kLCh7E+ti+iNmaX40KsM0nEZo1h0O5ahj+1QORfVDESnfnPCrAw/IAaueb4Svi6yLnLmDHM2f3wKC7CZR3jkCwCk8yzAijj9kPn3NklyblBM6bLrT4pjuM9sDk+nsL8ab9zVadCubQyTRNXH4B18V5JbG64thzPwhO/Yf422AKfzQsgdrkBl+ICXDmwCmfhOpyGm/qQDvEZLuxZGaUis9aGRbqXymbm4b4WNMYZoQ/r6RUNmNaK+HulOBNp/rIvu6EA4mdxvYwmTUUT59x6tuUuuLUvePbHAMj5tCLynPu924qU/l28OKT0DbixANKKBI4SRvH+LEd5GWfcIsfRht7Szwsgdkchj5VLcGk5yoRcgcj27UNK/38AxDZv/7wJdigJfr0kOC+iUWtsCxrnuawyFdH5PLvD+MjzN6Oiz0HCtv9DqhL5lyv37rHB55mCboxwYVnnCTYKx7wtGBVk1uEFB/AvGXaeIV1AD1oAAAAASUVORK5CYII="}});
//# sourceMappingURL=17.71529afd996aa7d3c404.js.map